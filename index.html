<!DOCTYPE html>

<html class="dark" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Liquid Midnight | Product Portal</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#00e5ff",
                        "secondary": "#7b1fa2",
                        "background-light": "#f5f8f8",
                        "background-dark": "#000000",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #000000;
            overflow-x: hidden;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 229, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            border-color: rgba(0, 229, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 229, 255, 0.2);
            transform: translateY(-4px);
        }

        .liquid-blob {
            position: absolute;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.6;
        }

        .blob-1 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, #7b1fa2 0%, transparent 70%);
            top: -100px;
            left: -100px;
        }

        .blob-2 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, #00e5ff 0%, transparent 70%);
            bottom: -200px;
            right: -100px;
        }

        .blob-3 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, #7b1fa2 0%, transparent 70%);
            top: 40%;
            right: 10%;
        }

        .neon-glow {
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }

        .status-dot {
            box-shadow: 0 0 8px #00e5ff;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: #1a1a1a;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #00e5ff;
        }
    </style>
</head>
<body class="bg-background-dark text-slate-100 selection:bg-primary/30">
<!-- Background Animated Elements -->
<div class="fixed inset-0 overflow-hidden pointer-events-none">
<div class="liquid-blob blob-1"></div>
<div class="liquid-blob blob-2"></div>
<div class="liquid-blob blob-3"></div>
</div>
<!-- Navigation -->
<header class="fixed top-0 left-0 right-0 z-50 px-6 py-4">
<nav class="max-w-7xl mx-auto glass-panel rounded-xl px-8 py-3 flex items-center justify-between">
<a href="https://0n3-n1n3.github.io/h0med3c4r/" class="flex items-center gap-2 group cursor-pointer hover:opacity-80 transition-opacity">
<span class="material-symbols-outlined text-primary text-3xl">water_drop</span>
<span class="text-xl font-bold tracking-tighter uppercase">h0med3c0r</span>
</a>
</nav>
</header>
<main class="relative pt-32 pb-20 px-6">
<div class="max-w-7xl mx-auto">
<!-- Hero Section -->
<section class="flex flex-col items-center justify-center min-h-[50vh] text-center mb-32" id="heroSection">
<div class="max-w-2xl">
<h1 class="text-5xl md:text-7xl font-bold mb-6 tracking-tighter uppercase leading-none">
                        Experience <span class="text-primary italic">The Fluid</span> Home
                    </h1>

<div class="flex flex-wrap justify-center gap-4">
<a href="?view=catalogue" class="glass-panel border-primary hover:bg-primary/10 px-8 py-4 rounded-lg flex items-center gap-2 group transition-all cursor-pointer">
<span class="font-bold tracking-widest uppercase">View Catalogue</span>
<span class="material-symbols-outlined group-hover:translate-x-1 transition-transform">arrow_forward</span>
</a>
</div>
</div>
</section>

<!-- Featured Product Section -->
<section class="mb-32" id="featuredSection" style="display:none;">
<h2 class="text-3xl font-bold tracking-tight uppercase mb-8">Product Details</h2>
<div class="glass-card rounded-xl p-8">
<div class="grid grid-cols-1 md:grid-cols-2 gap-12">
<!-- Product Image -->
<div class="flex flex-col gap-4">
<div class="relative aspect-square overflow-hidden rounded-lg glass-panel p-4">
<img id="featuredImage" alt="Featured Product" class="w-full h-full object-contain" src=""/>
</div>
</div>
<!-- Product Details -->
<div class="flex flex-col justify-between">
<div>
<div class="mb-6">
<span class="text-xs text-primary font-mono font-bold tracking-widest mb-2 inline-block">#ID-<span id="featuredIdNum">0000</span></span>
<h1 class="font-bold text-4xl tracking-tight uppercase mt-3 mb-3" id="featuredName">Loading...</h1>
<div class="flex items-center gap-3 mb-6">
<div class="flex items-center gap-2 glass-panel px-3 py-1 rounded-full">
<div class="w-2 h-2 rounded-full bg-primary status-dot"></div>
<span class="text-xs font-bold uppercase tracking-widest">In Stock</span>
</div>
</div>
</div>
<div class="mb-8">
<h3 class="text-lg font-bold uppercase tracking-tight mb-3">About this product</h3>
<p class="text-slate-300 text-base leading-relaxed" id="featuredDesc">Loading product details...</p>
</div>
</div>
<!-- Action Buttons -->
<div class="flex flex-col gap-3">
<a id="amazonLink" href="#" target="_blank" class="w-full bg-primary hover:bg-primary/80 text-black py-4 rounded-lg font-bold text-sm uppercase tracking-widest transition-all flex items-center justify-center gap-2 group">
<span>View on Amazon</span>
<span class="material-symbols-outlined group-hover:translate-x-1 transition-transform">open_in_new</span>
</a>
<a href="/?view=catalogue" class="w-full bg-primary/10 hover:bg-primary/20 text-primary py-4 rounded-lg font-bold text-sm uppercase tracking-widest transition-all">
Back to Catalogue
</a>
</div>
</div>
</div>
</section>

<!-- Affiliated Products Section -->
<section class="mb-32" id="affiliatedSection" style="display:none;">
<div class="flex items-end justify-between mb-12">
<div>
<h2 class="text-3xl font-bold tracking-tight uppercase mb-2">Affiliated Products</h2>
<p class="text-slate-500 tracking-wide">Explore related items</p>
</div>
<div class="hidden md:block h-[1px] flex-1 mx-12 bg-gradient-to-r from-primary/30 to-transparent"></div>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="affiliatedGrid">
<!-- Products will be loaded here -->
</div>
</section>
</div>
</main>
<!-- Footer -->
<footer class="border-t border-white/5 py-12 px-6 bg-black/50 backdrop-blur-md">
<div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-8">
<div class="flex flex-col items-center md:items-start gap-2">
<div class="flex items-center gap-2 mb-2">
<span class="material-symbols-outlined text-primary">water_drop</span>
<span class="text-lg font-bold uppercase tracking-tighter">h0med3c0r</span>
</div>
<p class="text-slate-600 text-sm">Â© If you buy from here, i owe you one</p>
</div>
<div class="flex gap-8 text-xs font-bold uppercase tracking-widest">
<a class="text-slate-400 hover:text-primary transition-colors" href="https://www.pinterest.com/h0med3c0r">Pinterest</a>
</div>
<div class="flex items-center gap-3 glass-panel px-4 py-2 rounded-full">
<div class="w-2 h-2 rounded-full bg-primary animate-pulse status-dot"></div>
<span class="text-[10px] font-bold uppercase tracking-widest text-slate-300">All Systems Operational</span>
</div>
</div>
</footer>
<!-- Implementation Note Overlay (For Design Context) -->
<script>
// Google Apps Script URL
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwukcGuUb19vkMYGFTtwNJ1_l1TEdzsd-T8r117Xt4kyZHHeCwTmitkYXO11txgmR4r/exec';

// Get product ID from URL parameters
function getProductIdFromURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get('productid');
}

// Convert Google Drive sharing link to direct image URL
function convertGoogleDriveLink(driveLink) {
  if (!driveLink) return null;
  
  // Format: https://drive.google.com/file/d/{FILE_ID}/view?usp=sharing
  const fileIdMatch = driveLink.match(/\/d\/([a-zA-Z0-9-_]+)/);
  if (fileIdMatch) {
    const fileId = fileIdMatch[1];
    // Use export=download instead of export=view for better image compatibility
    return `https://drive.google.com/uc?export=download&id=${fileId}`;
  }
  
  // If it's already a direct link, return as-is
  return driveLink;
}

// Extract ASIN from Amazon link and get image URL
function getAmazonImageUrl(amazonLink) {
  if (!amazonLink) return null;
  
  // Extract ASIN from various Amazon URL formats
  let asin = null;
  
  // Format: https://amzn.in/d/{ASIN}
  const shortMatch = amazonLink.match(/amzn\.in\/d\/([a-zA-Z0-9]+)/);
  if (shortMatch) {
    asin = shortMatch[1];
  }
  
  // Format: amazon.com/dp/{ASIN}
  if (!asin) {
    const dpMatch = amazonLink.match(/\/dp\/([a-zA-Z0-9]+)/);
    if (dpMatch) {
      asin = dpMatch[1];
    }
  }
  
  // If we found an ASIN, construct the image URL
  if (asin) {
    return `https://images-na.ssl-images-amazon.com/images/P/${asin}.jpg`;
  }
  
  return null;
}

// Fetch products from Google Sheet
async function fetchProducts() {
  try {
    const response = await fetch(APPS_SCRIPT_URL);
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Error fetching products:', error);
    return [];
  }
}

// Display featured product
function displayFeaturedProduct(product) {
  const featuredSection = document.getElementById('featuredSection');
  const heroSection = document.getElementById('heroSection');
  
  if (product) {
    // Get image - use Image field (Google Drive link) and convert to direct URL
    let imageUrl = product.Image;
    if (imageUrl && imageUrl.trim() !== '') {
      // Convert Google Drive link to direct access URL
      imageUrl = convertGoogleDriveLink(imageUrl);
    } else {
      // Fallback if no image provided
      imageUrl = 'https://via.placeholder.com/400?text=' + encodeURIComponent(product.Name);
    }
    
    document.getElementById('featuredImage').src = imageUrl;
    
    // Set product name
    document.getElementById('featuredName').textContent = product.Name || 'Product Name';
    
    // Set product ID
    document.getElementById('featuredIdNum').textContent = product.Id;
    
    // Set description
    document.getElementById('featuredDesc').textContent = `${product.Name} - Available on Amazon. Click the button below to view and purchase this product.`;
    
    // Set Amazon link
    const amazonLink = document.getElementById('amazonLink');
    if (product.Link) {
      amazonLink.href = product.Link;
    } else {
      amazonLink.style.opacity = '0.5';
      amazonLink.style.pointerEvents = 'none';
    }
    
    heroSection.style.display = 'none';
    featuredSection.style.display = 'block';
    
    // Scroll to featured product
    featuredSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }
}

// Display affiliated products
function displayAffiliatedProducts(products, excludeProductId) {
  const affiliatedSection = document.getElementById('affiliatedSection');
  const affiliatedGrid = document.getElementById('affiliatedGrid');
  
  const filtered = products.filter(p => p.Id !== excludeProductId);
  
  if (filtered.length > 0) {
    affiliatedGrid.innerHTML = filtered.map(product => {
      let imgUrl = product.Image;
      if (imgUrl && imgUrl.trim() !== '') {
        // Convert Google Drive link to direct URL
        imgUrl = convertGoogleDriveLink(imgUrl);
      } else {
        imgUrl = 'https://via.placeholder.com/300?text=' + encodeURIComponent(product.Name);
      }
      
      return `
      <div class="glass-card rounded-xl p-1 group">
        <div class="relative aspect-square overflow-hidden rounded-lg mb-4 bg-black/50 flex items-center justify-center">
          <img alt="${product.Name}" class="w-full h-full object-contain group-hover:scale-110 transition-transform duration-700" src="${imgUrl}"/>
          <div class="absolute top-3 right-3 glass-panel rounded-full px-2 py-1 flex items-center gap-1.5">
            <div class="w-2 h-2 rounded-full bg-primary status-dot"></div>
            <span class="text-[10px] font-bold uppercase tracking-widest">Available</span>
          </div>
        </div>
        <div class="px-4 pb-4">
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-bold text-lg tracking-tight uppercase">${product.Name || 'Product'}</h3>
            <span class="text-xs text-primary font-mono">#ID-${product.Id}</span>
          </div>
          <p class="text-slate-500 text-sm mb-6 line-clamp-2">${product.Name}</p>
          <a href="?productid=${product.Id}" class="w-full bg-primary/10 hover:bg-primary text-primary hover:text-black py-3 rounded font-bold text-xs uppercase tracking-widest transition-all block text-center">
            View Product
          </a>
        </div>
      </div>
    `;
    }).join('');
    
    affiliatedSection.style.display = 'block';
  }
}// Display catalogue view with 5 columns
function displayCatalogueView(products) {
  const heroSection = document.getElementById('heroSection');
  const featuredSection = document.getElementById('featuredSection');
  const affiliatedSection = document.getElementById('affiliatedSection');
  
  heroSection.style.display = 'none';
  featuredSection.style.display = 'none';
  affiliatedSection.style.display = 'block';
  
  const heading = affiliatedSection.querySelector('h2');
  heading.textContent = 'Complete Catalogue';
  
  const desc = affiliatedSection.querySelector('p');
  desc.textContent = `Browse all ${products.length} available products`;
  
  const affiliatedGrid = document.getElementById('affiliatedGrid');
  affiliatedGrid.className = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6';
  
  if (products && products.length > 0) {
    const html = products.map(product => {
      let imgUrl = product.Image;
      if (imgUrl && imgUrl.trim() !== '') {
        imgUrl = convertGoogleDriveLink(imgUrl);
      } else {
        imgUrl = 'https://via.placeholder.com/300?text=' + encodeURIComponent(product.Name);
      }
      
      return `<div class="glass-card rounded-xl p-1 group h-full flex flex-col">
        <div class="relative aspect-square overflow-hidden rounded-lg mb-4 bg-black/50 flex items-center justify-center">
          <img alt="${product.Name}" class="w-full h-full object-contain group-hover:scale-105 transition-transform duration-500" src="${imgUrl}"/>
          <div class="absolute top-3 right-3 glass-panel rounded-full px-2 py-1 flex items-center gap-1.5">
            <div class="w-2 h-2 rounded-full bg-primary status-dot"></div>
            <span class="text-[10px] font-bold uppercase tracking-widest">Stock</span>
          </div>
        </div>
        <div class="px-4 pb-4 flex flex-col justify-between flex-grow">
          <div>
            <div class="flex justify-between items-start mb-2 gap-2">
              <h3 class="font-bold text-base tracking-tight uppercase line-clamp-2">${product.Name || 'Product'}</h3>
              <span class="text-xs text-primary font-mono whitespace-nowrap">#${product.Id}</span>
            </div>
            <p class="text-slate-500 text-xs mb-4">${product.Name}</p>
          </div>
          <a href="?productid=${product.Id}" class="w-full bg-primary/10 hover:bg-primary text-primary hover:text-black py-2 rounded font-bold text-xs uppercase tracking-widest transition-all">
            View Details
          </a>
        </div>
      </div>`;
    }).join('');
    
    affiliatedGrid.innerHTML = html;
  } else {
    affiliatedGrid.innerHTML = '<p class="col-span-full text-center text-slate-400">No products available</p>';
  }
}

// Initialize page
async function initializePage() {
  const params = new URLSearchParams(window.location.search);
  const viewMode = params.get('view');
  const productId = params.get('productid');
  const products = await fetchProducts();
  
  console.log('Products fetched:', products.length);
  console.log('View mode:', viewMode);
  
  if (viewMode === 'catalogue') {
    displayCatalogueView(products || []);
  } else if (productId && products.length > 0) {
    const featured = products.find(p => String(p.Id) === String(productId));
    
    if (featured) {
      displayFeaturedProduct(featured);
      displayAffiliatedProducts(products, parseInt(productId));
    } else {
      displayAffiliatedProducts(products);
    }
  }
}

// Run when page loads
document.addEventListener('DOMContentLoaded', initializePage);
</script>

</body></html>
